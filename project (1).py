# -*- coding: utf-8 -*-
"""Project.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1L3iNN_bcA1ZZd4WD6aLKGL3mip5LsgWQ

## **PROJECT**

**TITLE: Fashion item classification**

GROUP MEMBERS:

*  Piyush Rao 202210101150130
*  Abhishek Kumar 202210101150150
*  Snehal Tiwari 202210101150127

---

**Importing the necessary libraries:**
"""

import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Dense, Flatten, Conv2D, MaxPooling2D
from tensorflow.keras.utils import to_categorical
from sklearn.model_selection import train_test_split

"""**Import the dataset:**"""

from keras.datasets import fashion_mnist

(X_train, y_train), (X_test, y_test) = fashion_mnist.load_data()

X_train.shape, X_test.shape

"""**Visualizing Fashion Images:**"""

label_names = ['T-shirt/top', 'Trouser', 'Pullover', 'Dress', 'Coat',
               'Sandal', 'Shirt', 'Sneaker', 'Bag', 'Ankle boot']

plt.figure(figsize=(10,5))
for i in range(10):
    plt.subplot(2,5,i+1)
    plt.imshow(X_train[i], cmap='grey')
    plt.title(label_names[y_train[i]])
    plt.axis('off')
plt.show()

"""**Preprocessing the Data:**"""

# Normalize pixel values (0-255 â†’ 0-1)
X_train = X_train / 255.0
X_test = X_test / 255.0

# Reshape for CNN (28,28 â†’ 28,28,1)
X_train = X_train.reshape(-1, 28, 28, 1)
X_test = X_test.reshape(-1, 28, 28, 1)

# One-hot encoding
y_train = to_categorical(y_train)
y_test = to_categorical(y_test)

"""**Building Fashion Classifier:**"""

from tensorflow.keras import Input, Sequential
from tensorflow.keras.layers import Conv2D, MaxPooling2D, Flatten, Dense

model = Sequential([
    Input(shape=(28,28,1)),    # ðŸ‘ˆ ye nayi line add karo
    Conv2D(32, (3,3), activation='relu'),
    MaxPooling2D(2,2),
    Conv2D(64, (3,3), activation='relu'),
    MaxPooling2D(2,2),
    Flatten(),
    Dense(128, activation='relu'),
    Dense(10, activation='softmax')
])

"""**Train The Model:**"""

(X_train, y_train), (X_test, y_test) = fashion_mnist.load_data()
X_train, X_test = X_train / 255.0, X_test / 255.0

model = Sequential([
    Flatten(input_shape=(28,28)),
    Dense(128, activation='relu'),
    Dense(10, activation='softmax')
])

model.compile(optimizer='adam',
              loss='sparse_categorical_crossentropy',
              metrics=['accuracy'])

history = model.fit(X_train, y_train, epochs=5, validation_data=(X_test, y_test))

"""**Plot Accuracy & Loss Graphs:**"""

plt.figure(figsize=(10,4))
plt.subplot(1,2,1)
plt.plot(history.history['accuracy'], label='Train Accuracy')
plt.plot(history.history['val_accuracy'], label='Val Accuracy')
plt.legend()
plt.title('Model Accuracy')

plt.subplot(1,2,2)
plt.plot(history.history['loss'], label='Train Loss')
plt.plot(history.history['val_loss'], label='Val Loss')
plt.legend()
plt.title('Model Loss')
plt.show()

"""**Evaluate Model Performance:**"""

test_loss, test_acc = model.evaluate(X_test, y_test)
print(f"Test Accuracy: {test_acc:.2f}")

"""**Prediction Visualization:**"""

pred = model.predict(X_test)
pred_labels = np.argmax(pred, axis=1)
true_labels = y_test

label_names = ['T-shirt', 'Trouser', 'Pullover', 'Dress', 'Coat',
               'Sandal', 'Shirt', 'Sneaker', 'Bag', 'Ankle boot']

import matplotlib.pyplot as plt
plt.figure(figsize=(10,5))
for i in range(10):
    plt.subplot(2,5,i+1)
    plt.imshow(X_test[i].reshape(28,28), cmap='gray')
    plt.title(f"Pred: {label_names[pred_labels[i]]}\nTrue: {label_names[true_labels[i]]}")
    plt.axis('off')
plt.show()

"""## Conclusion & Future Scope:

Achieved solid accuracy using a simple CNN.

Model can be improved with data augmentation, dropout, and more epochs.

Fashion MNIST helps beginners understand CNNs through fashion!


"""

